{
  "timestamp": "None",
  "tables": {
    "carriers": [
      "id",
      "name",
      "created_at"
    ],
    "chat_messages": [
      "id",
      "trip_id",
      "from_user",
      "to_role",
      "body",
      "created_at"
    ],
    "checklists": [
      "id",
      "trip_id",
      "driver_id",
      "items",
      "created_at"
    ],
    "companies": [
      "id",
      "name",
      "created_at"
    ],
    "driver_positions": [
      "id",
      "trip_id",
      "driver_id",
      "lat",
      "lng",
      "speed",
      "timestamp"
    ],
    "gf_alerts": [
      "id",
      "alert_type",
      "severity",
      "trip_id",
      "route_id",
      "vehicle_id",
      "driver_id",
      "passenger_id",
      "company_id",
      "message",
      "metadata",
      "is_read",
      "is_resolved",
      "resolved_at",
      "resolved_by",
      "created_at"
    ],
    "gf_assistance_requests": [
      "id",
      "trip_id",
      "route_id",
      "vehicle_id",
      "driver_id",
      "request_type",
      "description",
      "latitude",
      "longitude",
      "address",
      "status",
      "dispatched_driver_id",
      "dispatched_vehicle_id",
      "resolved_at",
      "resolved_by",
      "created_at",
      "updated_at"
    ],
    "gf_driver_documents": [
      "id",
      "driver_id",
      "document_type",
      "document_number",
      "expiry_date",
      "file_url",
      "file_name",
      "is_valid",
      "notes",
      "created_at",
      "updated_at"
    ],
    "gf_driver_events": [
      "id",
      "driver_id",
      "event_type",
      "meta",
      "points",
      "created_at"
    ],
    "gf_employee_company": [
      "id",
      "company_id",
      "name",
      "cpf",
      "address",
      "latitude",
      "longitude",
      "phone",
      "email",
      "login_cpf",
      "password_hash",
      "is_active",
      "created_by",
      "created_at",
      "updated_at"
    ],
    "gf_roles": [
      "id",
      "name",
      "description",
      "permissions",
      "created_at",
      "updated_at"
    ],
    "gf_route_plan": [
      "id",
      "route_id",
      "stop_order",
      "latitude",
      "longitude",
      "address",
      "stop_name",
      "passenger_id",
      "employee_id",
      "estimated_arrival_time",
      "created_at",
      "updated_at"
    ],
    "gf_user_roles": [
      "id",
      "user_id",
      "role_id",
      "assigned_by",
      "assigned_at",
      "expires_at"
    ],
    "gf_vehicle_costs": [
      "id",
      "vehicle_id",
      "route_id",
      "trip_id",
      "km",
      "fuel",
      "maintenance",
      "other_costs",
      "total",
      "date",
      "notes",
      "created_at",
      "updated_at"
    ],
    "gf_vehicle_maintenance": [
      "id",
      "vehicle_id",
      "maintenance_type",
      "description",
      "km_at_service",
      "cost",
      "service_date",
      "next_service_date",
      "next_service_km",
      "service_provider",
      "notes",
      "created_by",
      "created_at",
      "updated_at"
    ],
    "passenger_reports": [
      "id",
      "trip_id",
      "passenger_id",
      "kind",
      "message",
      "created_at"
    ],
    "profiles": [
      "id",
      "email",
      "name",
      "role",
      "company_id",
      "carrier_id"
    ],
    "route_stops": [
      "id",
      "route_id",
      "seq",
      "name",
      "lat",
      "lng",
      "radius_m"
    ],
    "routes": [
      "id",
      "name",
      "company_id",
      "carrier_id",
      "created_at"
    ],
    "trip_events": [
      "id",
      "trip_id",
      "driver_id",
      "event_type",
      "description",
      "lat",
      "lng",
      "timestamp"
    ],
    "trip_passengers": [
      "trip_id",
      "passenger_id"
    ],
    "trip_summary": [
      "id",
      "trip_id",
      "samples",
      "total_distance_km",
      "duration_minutes",
      "avg_speed_kmh",
      "start_time",
      "end_time",
      "created_at",
      "updated_at"
    ],
    "trips": [
      "id",
      "route_id",
      "vehicle_id",
      "driver_id",
      "status",
      "scheduled_at",
      "started_at",
      "completed_at",
      "updated_at",
      "passenger_ids"
    ],
    "users": [
      "id",
      "email",
      "role",
      "company_id",
      "carrier_id",
      "created_at",
      "updated_at"
    ],
    "v_active_trips": [
      "trip_id",
      "route_id",
      "driver_id",
      "vehicle_id",
      "status",
      "scheduled_at",
      "started_at",
      "route_name",
      "origin",
      "destination",
      "company_id",
      "company_name",
      "driver_name",
      "driver_email",
      "vehicle_plate",
      "vehicle_model",
      "active_passengers",
      "picked_up_count",
      "last_lat",
      "last_lng",
      "last_speed",
      "last_position_at",
      "time_since_update"
    ],
    "v_driver_last_position": [
      "driver_id",
      "trip_id",
      "lat",
      "lng",
      "speed",
      "heading",
      "accuracy",
      "captured_at",
      "time_since_update"
    ],
    "v_route_stops": [
      "id",
      "route_id",
      "stop_order",
      "latitude",
      "longitude",
      "address",
      "stop_name",
      "passenger_id",
      "employee_id",
      "passenger_name",
      "passenger_email",
      "created_at",
      "route_name"
    ],
    "v_trip_latest_position": [
      "trip_id",
      "driver_id",
      "lat",
      "lng",
      "speed",
      "last_seen_at"
    ],
    "v_trip_overview": [
      "trip_id",
      "status",
      "scheduled_at",
      "route_name",
      "vehicle_plate",
      "vehicle_model",
      "driver_id"
    ],
    "vehicles": [
      "id",
      "plate",
      "model",
      "carrier_id",
      "created_at"
    ]
  },
  "views": [
    "profiles",
    "v_active_trips",
    "v_driver_last_position",
    "v_route_stops",
    "v_trip_latest_position",
    "v_trip_overview"
  ],
  "functions": [
    "calculate_trip_summary",
    "current_carrier_id",
    "current_company_id",
    "current_role",
    "get_driver_position_lat",
    "get_driver_position_lng",
    "get_user_carrier_id",
    "get_user_company_id",
    "get_user_name",
    "get_user_role",
    "gf_map_snapshot_full",
    "handle_new_user",
    "is_admin",
    "recalculate_trip_summary_on_position",
    "rpc_trip_transition",
    "update_updated_at_column"
  ],
  "missing_tables": [
    "drivers",
    "bus_stops"
  ],
  "missing_views": [],
  "missing_functions": [],
  "foreign_keys": 51,
  "rls_policies": 47,
  "indexes": 64
}