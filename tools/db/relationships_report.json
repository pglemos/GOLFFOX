{
  "timestamp": "2025-11-02T05:04:14.647695",
  "foreign_keys_count": 51,
  "foreign_keys": [
    {
      "table_name": "chat_messages",
      "column_name": "from_user",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "chat_messages_from_user_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "chat_messages",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "chat_messages_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "checklists",
      "column_name": "driver_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "checklists_driver_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "checklists",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "checklists_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "driver_positions",
      "column_name": "driver_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "driver_positions_driver_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "driver_positions",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "driver_positions_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_alerts",
      "column_name": "company_id",
      "foreign_table_name": "companies",
      "foreign_column_name": "id",
      "constraint_name": "gf_alerts_company_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_alerts",
      "column_name": "driver_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_alerts_driver_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_alerts",
      "column_name": "passenger_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_alerts_passenger_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_alerts",
      "column_name": "resolved_by",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_alerts_resolved_by_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_alerts",
      "column_name": "route_id",
      "foreign_table_name": "routes",
      "foreign_column_name": "id",
      "constraint_name": "gf_alerts_route_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_alerts",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "gf_alerts_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_alerts",
      "column_name": "vehicle_id",
      "foreign_table_name": "vehicles",
      "foreign_column_name": "id",
      "constraint_name": "gf_alerts_vehicle_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_assistance_requests",
      "column_name": "dispatched_driver_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_assistance_requests_dispatched_driver_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_assistance_requests",
      "column_name": "dispatched_vehicle_id",
      "foreign_table_name": "vehicles",
      "foreign_column_name": "id",
      "constraint_name": "gf_assistance_requests_dispatched_vehicle_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_assistance_requests",
      "column_name": "driver_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_assistance_requests_driver_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_assistance_requests",
      "column_name": "resolved_by",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_assistance_requests_resolved_by_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_assistance_requests",
      "column_name": "route_id",
      "foreign_table_name": "routes",
      "foreign_column_name": "id",
      "constraint_name": "gf_assistance_requests_route_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_assistance_requests",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "gf_assistance_requests_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_assistance_requests",
      "column_name": "vehicle_id",
      "foreign_table_name": "vehicles",
      "foreign_column_name": "id",
      "constraint_name": "gf_assistance_requests_vehicle_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_driver_documents",
      "column_name": "driver_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_driver_documents_driver_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_driver_events",
      "column_name": "driver_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_driver_events_driver_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_employee_company",
      "column_name": "company_id",
      "foreign_table_name": "companies",
      "foreign_column_name": "id",
      "constraint_name": "gf_employee_company_company_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_employee_company",
      "column_name": "created_by",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_employee_company_created_by_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_route_plan",
      "column_name": "employee_id",
      "foreign_table_name": "gf_employee_company",
      "foreign_column_name": "id",
      "constraint_name": "gf_route_plan_employee_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_route_plan",
      "column_name": "passenger_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_route_plan_passenger_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_route_plan",
      "column_name": "route_id",
      "foreign_table_name": "routes",
      "foreign_column_name": "id",
      "constraint_name": "gf_route_plan_route_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_user_roles",
      "column_name": "assigned_by",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_user_roles_assigned_by_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_user_roles",
      "column_name": "role_id",
      "foreign_table_name": "gf_roles",
      "foreign_column_name": "id",
      "constraint_name": "gf_user_roles_role_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_user_roles",
      "column_name": "user_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_user_roles_user_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_vehicle_costs",
      "column_name": "route_id",
      "foreign_table_name": "routes",
      "foreign_column_name": "id",
      "constraint_name": "gf_vehicle_costs_route_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_vehicle_costs",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "gf_vehicle_costs_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_vehicle_costs",
      "column_name": "vehicle_id",
      "foreign_table_name": "vehicles",
      "foreign_column_name": "id",
      "constraint_name": "gf_vehicle_costs_vehicle_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "gf_vehicle_maintenance",
      "column_name": "created_by",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "gf_vehicle_maintenance_created_by_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "SET NULL"
    },
    {
      "table_name": "gf_vehicle_maintenance",
      "column_name": "vehicle_id",
      "foreign_table_name": "vehicles",
      "foreign_column_name": "id",
      "constraint_name": "gf_vehicle_maintenance_vehicle_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "passenger_reports",
      "column_name": "passenger_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "passenger_reports_passenger_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "passenger_reports",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "passenger_reports_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "route_stops",
      "column_name": "route_id",
      "foreign_table_name": "routes",
      "foreign_column_name": "id",
      "constraint_name": "route_stops_route_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "routes",
      "column_name": "carrier_id",
      "foreign_table_name": "carriers",
      "foreign_column_name": "id",
      "constraint_name": "routes_carrier_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "NO ACTION"
    },
    {
      "table_name": "routes",
      "column_name": "company_id",
      "foreign_table_name": "companies",
      "foreign_column_name": "id",
      "constraint_name": "routes_company_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "NO ACTION"
    },
    {
      "table_name": "trip_events",
      "column_name": "driver_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "trip_events_driver_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "NO ACTION"
    },
    {
      "table_name": "trip_events",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "trip_events_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "trip_passengers",
      "column_name": "passenger_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "trip_passengers_passenger_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "trip_passengers",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "trip_passengers_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "trip_summary",
      "column_name": "trip_id",
      "foreign_table_name": "trips",
      "foreign_column_name": "id",
      "constraint_name": "trip_summary_trip_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "CASCADE"
    },
    {
      "table_name": "trips",
      "column_name": "driver_id",
      "foreign_table_name": "users",
      "foreign_column_name": "id",
      "constraint_name": "trips_driver_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "NO ACTION"
    },
    {
      "table_name": "trips",
      "column_name": "route_id",
      "foreign_table_name": "routes",
      "foreign_column_name": "id",
      "constraint_name": "trips_route_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "NO ACTION"
    },
    {
      "table_name": "trips",
      "column_name": "vehicle_id",
      "foreign_table_name": "vehicles",
      "foreign_column_name": "id",
      "constraint_name": "trips_vehicle_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "NO ACTION"
    },
    {
      "table_name": "users",
      "column_name": "carrier_id",
      "foreign_table_name": "carriers",
      "foreign_column_name": "id",
      "constraint_name": "users_carrier_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "NO ACTION"
    },
    {
      "table_name": "users",
      "column_name": "company_id",
      "foreign_table_name": "companies",
      "foreign_column_name": "id",
      "constraint_name": "users_company_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "NO ACTION"
    },
    {
      "table_name": "vehicles",
      "column_name": "carrier_id",
      "foreign_table_name": "carriers",
      "foreign_column_name": "id",
      "constraint_name": "vehicles_carrier_id_fkey",
      "update_rule": "NO ACTION",
      "delete_rule": "NO ACTION"
    }
  ],
  "orphaned_records": [],
  "missing_indexes": [
    {
      "table": "chat_messages",
      "column": "from_user"
    },
    {
      "table": "chat_messages",
      "column": "trip_id"
    },
    {
      "table": "checklists",
      "column": "driver_id"
    },
    {
      "table": "checklists",
      "column": "trip_id"
    },
    {
      "table": "driver_positions",
      "column": "driver_id"
    },
    {
      "table": "gf_alerts",
      "column": "company_id"
    },
    {
      "table": "gf_alerts",
      "column": "driver_id"
    },
    {
      "table": "gf_alerts",
      "column": "passenger_id"
    },
    {
      "table": "gf_alerts",
      "column": "resolved_by"
    },
    {
      "table": "gf_alerts",
      "column": "route_id"
    },
    {
      "table": "gf_alerts",
      "column": "vehicle_id"
    },
    {
      "table": "gf_assistance_requests",
      "column": "dispatched_driver_id"
    },
    {
      "table": "gf_assistance_requests",
      "column": "dispatched_vehicle_id"
    },
    {
      "table": "gf_assistance_requests",
      "column": "driver_id"
    },
    {
      "table": "gf_assistance_requests",
      "column": "resolved_by"
    },
    {
      "table": "gf_assistance_requests",
      "column": "route_id"
    },
    {
      "table": "gf_assistance_requests",
      "column": "vehicle_id"
    },
    {
      "table": "gf_employee_company",
      "column": "created_by"
    },
    {
      "table": "gf_route_plan",
      "column": "employee_id"
    },
    {
      "table": "gf_user_roles",
      "column": "assigned_by"
    },
    {
      "table": "gf_vehicle_costs",
      "column": "trip_id"
    },
    {
      "table": "gf_vehicle_maintenance",
      "column": "created_by"
    },
    {
      "table": "passenger_reports",
      "column": "passenger_id"
    },
    {
      "table": "passenger_reports",
      "column": "trip_id"
    },
    {
      "table": "route_stops",
      "column": "route_id"
    },
    {
      "table": "trip_events",
      "column": "driver_id"
    },
    {
      "table": "trips",
      "column": "vehicle_id"
    },
    {
      "table": "users",
      "column": "carrier_id"
    },
    {
      "table": "users",
      "column": "company_id"
    },
    {
      "table": "vehicles",
      "column": "carrier_id"
    }
  ],
  "relationship_stats": [
    {
      "name": "Users -> Companies (via drivers)",
      "error": "relation \"drivers\" does not exist\nLINE 3:                 WHERE EXISTS (SELECT 1 FROM drivers d WHERE ...\n                                                    ^\n"
    },
    {
      "name": "Drivers -> Vehicles (via trips)",
      "error": "current transaction is aborted, commands ignored until end of transaction block\n"
    },
    {
      "name": "Routes -> Bus Stops",
      "error": "current transaction is aborted, commands ignored until end of transaction block\n"
    },
    {
      "name": "Trips -> Driver Positions",
      "error": "current transaction is aborted, commands ignored until end of transaction block\n"
    }
  ]
}