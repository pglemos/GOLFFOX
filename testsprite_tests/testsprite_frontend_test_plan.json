[
  {
    "id": "TC001",
    "title": "User Login Success",
    "description": "Verify that users can log in successfully with valid credentials and receive a session cookie and correct role-based redirection.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Navigate to login API endpoint."
      },
      {
        "type": "action",
        "description": "Submit valid email and password."
      },
      {
        "type": "assertion",
        "description": "Check HTTP 200 response with authentication token and user object."
      },
      {
        "type": "assertion",
        "description": "Verify session cookie is set."
      },
      {
        "type": "assertion",
        "description": "Confirm user is redirected to the panel matching their role."
      }
    ]
  },
  {
    "id": "TC002",
    "title": "User Login Failure with Invalid Credentials",
    "description": "Ensure login is rejected when incorrect email or password are provided and appropriate error is returned.",
    "category": "error handling",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Navigate to login API endpoint."
      },
      {
        "type": "action",
        "description": "Submit invalid or incorrect email and/or password."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 401 Unauthorized response."
      },
      {
        "type": "assertion",
        "description": "Ensure no session cookie is set."
      }
    ]
  },
  {
    "id": "TC003",
    "title": "CSRF Token Request and Validation",
    "description": "Validate that a CSRF token can be retrieved via the API and is required for state-changing requests.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Invoke GET /api/auth/csrf endpoint."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 200 with a valid CSRF token string."
      },
      {
        "type": "action",
        "description": "Attempt state-changing API request (e.g., vehicle create) without CSRF token."
      },
      {
        "type": "assertion",
        "description": "Ensure request is rejected due to missing CSRF token."
      },
      {
        "type": "action",
        "description": "Retry state-changing request with valid CSRF token."
      },
      {
        "type": "assertion",
        "description": "Request is accepted and processed successfully."
      }
    ]
  },
  {
    "id": "TC004",
    "title": "Admin Creates Operator and Company",
    "description": "Test admin's ability to create a new operator and associated company via the Admin API including validation of required fields.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Authenticate as admin user."
      },
      {
        "type": "action",
        "description": "Send POST request to /api/admin/create-operator with valid companyName, operatorEmail, and optional operatorPhone."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 201 Created response."
      },
      {
        "type": "assertion",
        "description": "Verify the operator and company exist in the system with correct data."
      },
      {
        "type": "action",
        "description": "Send POST request missing required fields such as companyName or operatorEmail."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 400 Bad Request with error details."
      },
      {
        "type": "action",
        "description": "Send request without admin authorization header."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 401 Unauthorized."
      }
    ]
  },
  {
    "id": "TC005",
    "title": "Operator Creates Employee",
    "description": "Validate Operator API allows creation of employees (drivers or passengers) with required data and proper authorization.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Authenticate as an operator."
      },
      {
        "type": "action",
        "description": "Send POST request to /api/operator/create-employee with valid email, name, phone, and role."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 201 Created response."
      },
      {
        "type": "assertion",
        "description": "Confirm the employee record exists and is associated with operator's company."
      },
      {
        "type": "action",
        "description": "Submit employee creation request missing required fields such as email or name."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 400 Bad Request with validation error."
      }
    ]
  },
  {
    "id": "TC006",
    "title": "Real-Time GPS Tracking and Map Visualization",
    "description": "Confirm that real-time fleet locations are accurately updated and reflected on map visualizations for authorized users.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Log in as admin/operator with permission to view fleet."
      },
      {
        "type": "action",
        "description": "Open fleet tracking dashboard with map view."
      },
      {
        "type": "action",
        "description": "Simulate GPS location reports for buses."
      },
      {
        "type": "assertion",
        "description": "Map visuals update in real-time reflecting current bus locations."
      },
      {
        "type": "action",
        "description": "Request historical playback for bus routes."
      },
      {
        "type": "assertion",
        "description": "Map displays accurate historical bus movements."
      }
    ]
  },
  {
    "id": "TC007",
    "title": "Role-Based Access Control Enforcement",
    "description": "Ensure that users can only access data and API endpoints permitted by their role with middleware and RLS enforcement.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Authenticate as user with 'driver' role."
      },
      {
        "type": "action",
        "description": "Attempt API request to admin-only endpoint (e.g., create operator)."
      },
      {
        "type": "assertion",
        "description": "Access is denied with HTTP 403 Forbidden."
      },
      {
        "type": "action",
        "description": "Attempt to access data belonging to a different company tenant."
      },
      {
        "type": "assertion",
        "description": "Access is denied due to Row Level Security policies."
      }
    ]
  },
  {
    "id": "TC008",
    "title": "Cost Management Budget Creation and Reconciliation",
    "description": "Verify users can create budgets, view KPIs, reconcile costs, and import/export cost data correctly.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Authenticate as admin or authorized user."
      },
      {
        "type": "action",
        "description": "Create a new budget via POST /api/costs/budgets with valid name, amount, and period."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 201 with budget created."
      },
      {
        "type": "action",
        "description": "Retrieve current cost KPIs via GET /api/costs/kpis."
      },
      {
        "type": "assertion",
        "description": "Verify KPIs include totalCosts, budget, and variance."
      },
      {
        "type": "action",
        "description": "Perform cost reconciliation using /api/costs/reconcile endpoint with valid data."
      },
      {
        "type": "assertion",
        "description": "Costs are accurately reconciled and updated."
      },
      {
        "type": "action",
        "description": "Import cost data from supported formats."
      },
      {
        "type": "assertion",
        "description": "Imported data is persisted and validated."
      },
      {
        "type": "action",
        "description": "Export cost data and verify correctness of output formats."
      },
      {
        "type": "assertion",
        "description": "Exported files (CSV, Excel) contain accurate cost information."
      }
    ]
  },
  {
    "id": "TC009",
    "title": "Report Generation and Scheduling",
    "description": "Verify report generation in different formats and scheduling of automated report dispatch via APIs.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Request report run with valid reportType and format (pdf, excel, csv) via POST /api/reports/run."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 200 with generated report data."
      },
      {
        "type": "action",
        "description": "Schedule a report dispatch with reportType, schedule, and recipient list via POST /api/reports/schedule."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 201 confirming report is scheduled."
      },
      {
        "type": "action",
        "description": "On scheduled time, verify email dispatch occurs with report attachment."
      },
      {
        "type": "assertion",
        "description": "Recipients receive the correct report via email."
      }
    ]
  },
  {
    "id": "TC010",
    "title": "Health Check Endpoint Validity",
    "description": "Check that the health check API returns accurate application and database connection status.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send GET request to /api/health endpoint."
      },
      {
        "type": "assertion",
        "description": "Response HTTP 200 includes ok=true, supabase='ok', and valid timestamp."
      },
      {
        "type": "assertion",
        "description": "In case of database down, response is HTTP 500 or supabase status is 'error'."
      }
    ]
  },
  {
    "id": "TC011",
    "title": "Driver Mobile App Check-In and GPS Navigation",
    "description": "Validate that drivers can check-in/out and receive GPS navigation in the mobile app.",
    "category": "functional",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Log in via mobile app as a driver."
      },
      {
        "type": "action",
        "description": "Perform check-in operation."
      },
      {
        "type": "assertion",
        "description": "Check-in is successful and status updated."
      },
      {
        "type": "action",
        "description": "Simulate inbound GPS navigation route."
      },
      {
        "type": "assertion",
        "description": "Navigation instructions are displayed and update according to GPS location."
      },
      {
        "type": "action",
        "description": "Perform check-out operation."
      },
      {
        "type": "assertion",
        "description": "Status is updated and trip history logs check-out time."
      }
    ]
  },
  {
    "id": "TC012",
    "title": "Passenger Mobile App Real-Time Bus Tracking and Notifications",
    "description": "Ensure passengers can view real-time bus locations and receive notifications on the mobile app.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Log in as a passenger on mobile app."
      },
      {
        "type": "action",
        "description": "Open real-time fleet tracking view."
      },
      {
        "type": "assertion",
        "description": "Bus locations update in real-time accurately."
      },
      {
        "type": "action",
        "description": "Trigger a system alert notification (e.g., delay or incident)."
      },
      {
        "type": "assertion",
        "description": "Passenger receives notification promptly."
      }
    ]
  },
  {
    "id": "TC013",
    "title": "Audit Logs Capture and Security",
    "description": "Verify that relevant system actions and errors are logged with appropriate data sanitization and secure storage.",
    "category": "security",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Perform actions such as login, data CRUD, and report generation."
      },
      {
        "type": "assertion",
        "description": "Audit logs record these actions with timestamps, user id, and description."
      },
      {
        "type": "action",
        "description": "Generate an error, e.g., invalid API request."
      },
      {
        "type": "assertion",
        "description": "Error details logged with sanitized sensitive data."
      }
    ]
  },
  {
    "id": "TC014",
    "title": "Scheduled Cron Jobs Execution",
    "description": "Test that scheduled cron jobs for KPI refresh, cost MV refresh, and report dispatch execute successfully via their API triggers.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Trigger GET /api/cron/refresh-kpis."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 200 confirming KPIs updated."
      },
      {
        "type": "action",
        "description": "Trigger GET /api/cron/dispatch-reports."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 200 confirming scheduled reports dispatched."
      }
    ]
  },
  {
    "id": "TC015",
    "title": "API Rate Limiting Enforcement",
    "description": "Confirm that rate limiting is enforced on API endpoints to prevent abuse and DoS.",
    "category": "security",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Send a high volume of requests to an API endpoint within a short timeframe."
      },
      {
        "type": "assertion",
        "description": "Requests exceeding rate limit receive HTTP 429 Too Many Requests."
      }
    ]
  },
  {
    "id": "TC016",
    "title": "Middleware Permissions Validation",
    "description": "Ensure middleware correctly verifies user permissions and denies access to unauthorized routes.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Log in as a user with restricted permissions."
      },
      {
        "type": "action",
        "description": "Attempt to access protected API routes."
      },
      {
        "type": "assertion",
        "description": "Access is blocked with appropriate HTTP status codes."
      }
    ]
  },
  {
    "id": "TC017",
    "title": "Report Format Output Verification",
    "description": "Validate report generation in PDF, Excel, and CSV formats produces files with correct formatting and data integrity.",
    "category": "functional",
    "priority": "Medium",
    "steps": [
      {
        "type": "action",
        "description": "Run report generation API requests for each supported format."
      },
      {
        "type": "assertion",
        "description": "Generated report files conform to expected specifications and contain accurate report data."
      }
    ]
  },
  {
    "id": "TC018",
    "title": "Multi-Tenant Data Isolation",
    "description": "Validate that multi-tenant architecture enforces strict data isolation across companies with no cross-tenant leakage.",
    "category": "security",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Authenticate as user belonging to Company A."
      },
      {
        "type": "action",
        "description": "Attempt to access or manipulate data from Company B."
      },
      {
        "type": "assertion",
        "description": "Access is denied and data from other tenants is not visible."
      }
    ]
  },
  {
    "id": "TC019",
    "title": "API for Web Vitals Analytics Data Ingestion",
    "description": "Ensure analytics API receives and records Web Vitals metrics correctly for performance monitoring.",
    "category": "functional",
    "priority": "Low",
    "steps": [
      {
        "type": "action",
        "description": "Send POST request to /api/analytics/web-vitals with sample metrics payload."
      },
      {
        "type": "assertion",
        "description": "Receive HTTP 200 confirming metrics recorded."
      }
    ]
  },
  {
    "id": "TC020",
    "title": "Error Handling on Invalid API Inputs",
    "description": "Validate that invalid inputs to CRUD and other API endpoints return appropriate error codes and messages without system crashes.",
    "category": "error handling",
    "priority": "High",
    "steps": [
      {
        "type": "action",
        "description": "Send malformed or incomplete requests to vehicle, driver, and route CRUD endpoints."
      },
      {
        "type": "assertion",
        "description": "HTTP 400 Bad Request responses with meaningful validation error messages."
      },
      {
        "type": "action",
        "description": "Send requests with invalid authentication tokens."
      },
      {
        "type": "assertion",
        "description": "Return HTTP 401 Unauthorized."
      }
    ]
  }
]
