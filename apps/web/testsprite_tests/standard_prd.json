{
  "meta": {
    "project": "GolfFox - Sistema de Gest√£o de Transporte Urbano",
    "date": "2025-12-10",
    "prepared_by": "Pedro Guilherme - SynVolt"
  },
  "product_overview": "GolfFox is a comprehensive SaaS platform for urban corporate transportation management, designed to provide companies with integrated solutions for employee transport. It offers real-time GPS tracking, full fleet management, cost control, and a premium user experience for all stakeholders, including administrators, companies, carriers, drivers, and passengers.",
  "core_goals": [
    "Provide real-time GPS tracking and route visualization for corporate transportation fleets.",
    "Enable role-based access control with specialized dashboards to optimize operations and management.",
    "Facilitate efficient management of employees, vehicles, drivers, routes, and operational costs.",
    "Deliver analytics and KPIs for data-driven decision making.",
    "Support multi-tenant architecture with data isolation and secure authorization.",
    "Offer mobile applications for drivers and passengers with integrated communication and check-in features.",
    "Implement alert and notification systems for operational exceptions and emergencies.",
    "Ensure high performance, security, and scalability through modern technology stack and cloud infrastructure."
  ],
  "key_features": [
    "Authentication & Authorization with role-based access control for admin, company, carrier, driver, and passenger roles.",
    "Admin Dashboard with KPIs, fleet map with real-time tracking and playback, route and vehicle management, driver management with gamification, company and carrier CRUD operations, and detailed reports.",
    "Company Panel for managing employees, routes, costs, and service providers with geocoding and alert notifications.",
    "Carrier Panel to manage drivers, vehicles, routes, revenues, and financial reports.",
    "Mobile Apps for Drivers and Passengers enabling checklists, GPS navigation, QR/NFC embarkation, real-time bus tracking, notifications, and feedback.",
    "Google Maps API integration for advanced route visualization and fleet tracking.",
    "Real-time updates using Supabase subscriptions to synchronize data across the system.",
    "File upload and export capabilities including PDF, Excel, and map images.",
    "Operational alert system for route deviations and emergency assistance dispatch.",
    "Multi-tenant data model ensuring access segregation via database policies.",
    "Performance monitoring with web vitals tracking and error logging."
  ],
  "user_flow_summary": [
    "User accesses login page and submits credentials.",
    "System authenticates user and retrieves role from database.",
    "Based on role, the user is redirected to respective dashboard: admin (/admin), company (/empresa), carrier (/transportadora), or mobile app for driver/passenger.",
    "Admin manages companies, carriers, vehicles, drivers, routes, alerts, and reviews KPIs.",
    "Company users manage employees, assigned routes, costs, and receive notifications.",
    "Carrier users handle fleet, drivers, monitor routes, report and control costs.",
    "Drivers use mobile app to complete checklist, navigate routes, scan passengers for embarkation, and communicate with dispatch.",
    "Passengers use mobile app to track bus location, receive arrival notifications, view route details, and provide service feedback.",
    "Real-time location and status updates are propagated via Supabase Realtime subscriptions.",
    "Emergency occurrences can be dispatched and tracked by admin with communication to drivers."
  ],
  "validation_criteria": [
    "All user roles must authenticate successfully and be redirected to the correct panel or app area.",
    "Role-based access control implemented for every protected route and API endpoint.",
    "Real-time fleet tracking updates should refresh on the dashboard within 1 second delay.",
    "Alerts and notifications must trigger correctly based on operational events such as route deviations or emergencies.",
    "CRUD operations for entities (companies, vehicles, drivers, routes) must persist data and be reflected immediately in the UI.",
    "Reports generate correct aggregated data and export in specified formats (PDF, Excel, CSV).",
    "Mobile app checklists and QR/NFC scanning flows function reliably with offline fallback.",
    "System maintains above 99.9% uptime with API response times below 500ms p95.",
    "Data isolation ensured through Row Level Security and verified by user queries.",
    "Performance metrics and error logs must be recorded and accessible for monitoring.",
    "Security mechanisms including CSRF tokens, rate limiting, and encryption must be enforced consistently."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js 16",
      "React 19",
      "Tailwind CSS 4",
      "Supabase",
      "Radix UI",
      "Zustand",
      "React Query",
      "Jest",
      "Playwright",
      "Google Maps API",
      "Recharts"
    ],
    "features": [
      {
        "name": "Authentication & Authorization",
        "description": "User authentication with role-based access control (admin, empresa, transportadora, motorista, passageiro)",
        "files": [
          "lib/auth.ts",
          "lib/api-auth.ts",
          "lib/user-role.ts",
          "hooks/use-auth.ts",
          "hooks/use-auth-fast.tsx",
          "components/login/login-form.tsx"
        ]
      },
      {
        "name": "Admin Dashboard",
        "description": "Administrative panel with KPIs, fleet management, route monitoring, user management, and analytics",
        "files": [
          "app/admin/page.tsx",
          "app/admin/transportadoras/page.tsx",
          "app/admin/rotas/page.tsx",
          "app/admin/usuarios/page.tsx",
          "app/admin/contratos/page.tsx",
          "app/admin/alertas/page.tsx",
          "components/admin/admin-sidebar.tsx",
          "components/admin/admin-header.tsx"
        ]
      },
      {
        "name": "Company Panel (Empresa)",
        "description": "Company management panel for contracted companies to manage employees, routes, costs, and service providers",
        "files": [
          "app/empresa/page.tsx",
          "app/empresa/layout.tsx",
          "app/empresa/funcionarios/page.tsx",
          "app/empresa/rotas/page.tsx",
          "app/empresa/custos/page.tsx",
          "hooks/use-empresa-data.ts",
          "components/empresa/empresa-sidebar.tsx"
        ]
      },
      {
        "name": "Carrier Panel (Transportadora)",
        "description": "Carrier management panel for managing drivers, vehicles, routes, revenues, and margins",
        "files": [
          "app/transportadora/page.tsx",
          "app/transportadora/layout.tsx",
          "app/transportadora/motoristas/page.tsx",
          "app/transportadora/veiculos/page.tsx",
          "app/transportadora/rotas/page.tsx",
          "hooks/use-transportadora-data.ts",
          "components/transportadora/transportadora-sidebar.tsx"
        ]
      },
      {
        "name": "Fleet Map & Route Visualization",
        "description": "Interactive Google Maps integration for real-time fleet tracking, route visualization, and playback",
        "files": [
          "components/fleet-map.tsx",
          "components/advanced-route-map.tsx",
          "components/transportadora-map.tsx",
          "lib/google-maps.ts",
          "lib/google-maps-loader.ts",
          "lib/map-utils.ts",
          "lib/polyline-decoder.ts",
          "lib/playback-service.ts"
        ]
      },
      {
        "name": "Real-time Updates",
        "description": "Supabase real-time subscriptions for live data synchronization across the application",
        "files": [
          "lib/realtime-service.ts",
          "lib/supabase-sync.ts",
          "hooks/use-realtime-updates.ts",
          "hooks/use-supabase-sync.ts",
          "hooks/use-global-sync.tsx"
        ]
      },
      {
        "name": "KPI & Analytics",
        "description": "Key Performance Indicators and analytics dashboards with charts and metrics",
        "files": [
          "components/kpi-card.tsx",
          "components/charts/",
          "lib/kpi-utils.ts",
          "hooks/use-admin-kpis.ts"
        ]
      },
      {
        "name": "File Upload & Export",
        "description": "Document upload, PDF/Excel export, and map image export functionality",
        "files": [
          "hooks/use-file-upload.ts",
          "lib/export-utils.ts",
          "lib/export-map-png.ts",
          "lib/exports.ts",
          "lib/operator-export.ts"
        ]
      },
      {
        "name": "Operational Alerts",
        "description": "Alert system for route deviations, operational issues, and notifications",
        "files": [
          "lib/operational-alerts.ts",
          "lib/route-deviation-detector.ts",
          "components/operational-alerts-badge.tsx",
          "components/operational-alerts-notification.tsx",
          "components/alerts/"
        ]
      },
      {
        "name": "Address & Geocoding",
        "description": "Address validation, CEP lookup, and geocoding services",
        "files": [
          "components/address-autocomplete.tsx",
          "components/address-form.tsx",
          "lib/address-validator.ts",
          "lib/geocoding.ts",
          "lib/google-maps-reverse.ts",
          "hooks/use-cep.ts"
        ]
      },
      {
        "name": "UI Components",
        "description": "Reusable UI components based on Radix UI with premium styling",
        "files": [
          "components/ui/button.tsx",
          "components/ui/card.tsx",
          "components/ui/dialog.tsx",
          "components/ui/dropdown-menu.tsx",
          "components/ui/input.tsx",
          "components/ui/select.tsx",
          "components/ui/table.tsx",
          "components/ui/toast.tsx"
        ]
      },
      {
        "name": "Supabase Integration",
        "description": "Database operations, queries, and server-side Supabase client",
        "files": [
          "lib/supabase.ts",
          "lib/supabase-server.ts",
          "hooks/use-supabase-query.ts",
          "lib/repositories/"
        ]
      },
      {
        "name": "Performance Monitoring",
        "description": "Web vitals tracking and performance monitoring",
        "files": [
          "lib/web-vitals.ts",
          "lib/monitoring.ts",
          "hooks/use-performance.ts",
          "components/performance-monitor.tsx"
        ]
      },
      {
        "name": "Reports & Costs",
        "description": "Financial reports, cost tracking, and cost center management",
        "files": [
          "lib/costs/",
          "lib/reports/",
          "components/costs/",
          "app/admin/custos/",
          "app/empresa/custos/",
          "app/transportadora/custos/"
        ]
      },
      {
        "name": "Login Page",
        "description": "Premium login page with role-based authentication and theme support",
        "files": [
          "app/page.tsx",
          "components/login/"
        ]
      }
    ]
  }
}
